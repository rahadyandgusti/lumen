!function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/comment/continuecomment.js",["../../lib/codemirror"],b):b(CodeMirror)}(function(b){function n(e){if(e.getOption("disableInput"))return b.Pass;for(var c,a=e.listSelections(),d=[],h=0;h<a.length;h++){var t=a[h].head;if(!/\bcomment\b/.test(e.getTokenTypeAt(t)))return b.Pass;var q=e.getModeAt(t);if(c){if(c!=q)return b.Pass}else c=q;q=null;if(c.blockCommentStart&&
c.blockCommentContinue){var p,l=e.getLine(t.line).slice(0,t.ch),m=l.lastIndexOf(c.blockCommentEnd);if(-1==m||m!=t.ch-c.blockCommentEnd.length)if(-1<(p=l.lastIndexOf(c.blockCommentStart))&&p>m){if(q=l.slice(0,p),/\S/.test(q))for(q="",l=0;l<p;++l)q+=" "}else-1<(p=l.indexOf(c.blockCommentContinue))&&!/\S/.test(l.slice(0,p))&&(q=l.slice(0,p));null!=q&&(q+=c.blockCommentContinue)}null==q&&c.lineComment&&r(e)&&(l=e.getLine(t.line),p=l.indexOf(c.lineComment),-1<p&&(q=l.slice(0,p),/\S/.test(q)?q=null:q+=
c.lineComment+l.slice(p+c.lineComment.length).match(/^\s*/)[0]));if(null==q)return b.Pass;d[h]="\n"+q}e.operation(function(){for(var f=a.length-1;0<=f;f--)e.replaceRange(d[f],a[f].from(),a[f].to(),"+insert")})}function r(b){b=b.getOption("continueComments");return!b||"object"!=typeof b||!1!==b.continueLineComment}b.defineOption("continueComments",null,function(e,c,a){if(a&&a!=b.Init&&e.removeKeyMap("continueComment"),c)a="Enter","string"==typeof c?a=c:"object"==typeof c&&c.key&&(a=c.key),c={name:"continueComment"},
c[a]=n,e.addKeyMap(c)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/closebrackets.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(f,g){return"pairs"==g&&"string"==typeof f?f:"object"==typeof f&&null!=f[g]?f[g]:p[g]}function r(f){for(var g=0;g<f.length;g++){var k=f.charAt(g),a="'"+k+"'";m[a]||(m[a]=e(k))}}function e(f){return function(g){return a(g,f)}}function c(f){var g=f.state.closeBrackets;
return!g||g.override?g:f.getModeAt(f.getCursor()).closeBrackets||g}function a(f,g){var k=c(f);if(!k||f.getOption("disableInput"))return b.Pass;var a=n(k,"pairs"),m=a.indexOf(g);if(-1==m)return b.Pass;for(var h,k=n(k,"triples"),p=a.charAt(m+1)==g,e=f.listSelections(),r=0==m%2,C=0;C<e.length;C++){var w;w=e[C];var u=w.head,y=f.getRange(u,l(u.line,u.ch+1));if(r&&!w.empty())w="surround";else if(!p&&r||y!=g)if(p&&1<u.ch&&0<=k.indexOf(g)&&f.getRange(l(u.line,u.ch-2),u)==g+g&&(2>=u.ch||f.getRange(l(u.line,
u.ch-3),l(u.line,u.ch-2))!=g))w="addFour";else{if(p){if(b.isWordChar(y)||!t(f,u,g))return b.Pass}else if(!r||f.getLine(u.line).length!=u.ch&&!d(y,a)&&!/\s/.test(y))return b.Pass;w="both"}else w=p&&q(f,u)?"both":0<=k.indexOf(g)&&f.getRange(u,l(u.line,u.ch+3))==g+g+g?"skipThree":"skip";if(h){if(h!=w)return b.Pass}else h=w}var z=m%2?a.charAt(m-1):g,D=m%2?g:a.charAt(m+1);f.operation(function(){if("skip"==h)f.execCommand("goCharRight");else if("skipThree"==h)for(var g=0;3>g;g++)f.execCommand("goCharRight");
else if("surround"==h){for(var k=f.getSelections(),g=0;g<k.length;g++)k[g]=z+k[g]+D;f.replaceSelections(k,"around");k=f.listSelections().slice();for(g=0;g<k.length;g++){var a=k,m=g,c;c=k[g];var d=0<b.cmpPos(c.anchor,c.head);c={anchor:new l(c.anchor.line,c.anchor.ch+(d?-1:1)),head:new l(c.head.line,c.head.ch+(d?1:-1))};a[m]=c}f.setSelections(k)}else"both"==h?(f.replaceSelection(z+D,null),f.triggerElectric(z+D),f.execCommand("goCharLeft")):"addFour"==h&&(f.replaceSelection(z+z+z+z,"before"),f.execCommand("goCharRight"))})}
function d(f,g){var k=g.lastIndexOf(f);return-1<k&&1==k%2}function h(f,g){var k=f.getRange(l(g.line,g.ch-1),l(g.line,g.ch+1));return 2==k.length?k:null}function t(f,g,k){var a=f.getLine(g.line),m=f.getTokenAt(g);if(/\bstring2?\b/.test(m.type)||q(f,g))return!1;k=new b.StringStream(a.slice(0,g.ch)+k+a.slice(g.ch),4);for(k.pos=k.start=m.start;;){a=f.getMode().token(k,m.state);if(k.pos>=g.ch+1)return/\bstring2?\b/.test(a);k.start=k.pos}}function q(f,g){var k=f.getTokenAt(l(g.line,g.ch+1));return/\bstring/.test(k.type)&&
k.start==g.ch}var p={pairs:"()[]{}''\"\"",triples:"",explode:"[]{}"},l=b.Pos;b.defineOption("autoCloseBrackets",!1,function(f,g,k){k&&k!=b.Init&&(f.removeKeyMap(m),f.state.closeBrackets=null);g&&(r(n(g,"pairs")),f.state.closeBrackets=g,f.addKeyMap(m))});var m={Backspace:function(f){var g=c(f);if(!g||f.getOption("disableInput"))return b.Pass;for(var k=n(g,"pairs"),g=f.listSelections(),a=0;a<g.length;a++){if(!g[a].empty())return b.Pass;var m=h(f,g[a].head);if(!m||0!=k.indexOf(m)%2)return b.Pass}for(a=
g.length-1;0<=a;a--)k=g[a].head,f.replaceRange("",l(k.line,k.ch-1),l(k.line,k.ch+1),"+delete")},Enter:function(a){var g=c(a),g=g&&n(g,"explode");if(!g||a.getOption("disableInput"))return b.Pass;for(var k=a.listSelections(),m=0;m<k.length;m++){if(!k[m].empty())return b.Pass;var l=h(a,k[m].head);if(!l||0!=g.indexOf(l)%2)return b.Pass}a.operation(function(){var g=a.lineSeparator()||"\n";a.replaceSelection(g+g,null);a.execCommand("goCharLeft");k=a.listSelections();for(g=0;g<k.length;g++){var m=k[g].head.line;
a.indentLine(m,null,!0);a.indentLine(m+1,null,!0)}})}};r(p.pairs+"`")});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/xml-fold",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(a,f,g,k){this.line=f;this.ch=g;this.cm=a;this.text=a.getLine(f);this.min=k?Math.max(k.from,a.firstLine()):a.firstLine();this.max=k?Math.min(k.to-1,a.lastLine()):a.lastLine()}function r(a,f){var g=a.cm.getTokenTypeAt(p(a.line,f));return g&&/\btag\b/.test(g)}function e(a){if(!(a.line>=
a.max))return a.ch=0,a.text=a.cm.getLine(++a.line),!0}function c(a){if(!(a.line<=a.min))return a.text=a.cm.getLine(--a.line),a.ch=a.text.length,!0}function a(a){for(;;){var f=a.text.indexOf("\x3e",a.ch);if(-1==f){if(e(a))continue;break}if(r(a,f+1)){var g=a.text.lastIndexOf("/",f),g=-1<g&&!/\S/.test(a.text.slice(g+1,f));return a.ch=f+1,g?"selfClose":"regular"}a.ch=f+1}}function d(a){for(;;){var f=a.ch?a.text.lastIndexOf("\x3c",a.ch-1):-1;if(-1==f){if(c(a))continue;break}if(r(a,f+1)){l.lastIndex=f;
a.ch=f;var g=l.exec(a.text);if(g&&g.index==f)return g}else a.ch=f}}function h(a){for(;;){l.lastIndex=a.ch;var f=l.exec(a.text);if(!f){if(e(a))continue;break}if(r(a,f.index+1))return a.ch=f.index+f[0].length,f;a.ch=f.index+1}}function t(c,f){for(var g=[];;){var k,b=h(c),l=c.line,d=c.ch-(b?b[0].length:0);if(!b||!(k=a(c)))break;if("selfClose"!=k)if(b[1]){for(var q=g.length-1;0<=q;--q)if(g[q]==b[2]){g.length=q;break}if(0>q&&(!f||f==b[2]))return{tag:b[2],from:p(l,d),to:p(c.line,c.ch)}}else g.push(b[2])}}
function q(a,f){for(var g=[];;){var k;a:for(k=a;;){var b=k.ch?k.text.lastIndexOf("\x3e",k.ch-1):-1;if(-1==b){if(c(k))continue;k=void 0;break a}if(r(k,b+1)){var l=k.text.lastIndexOf("/",b),l=-1<l&&!/\S/.test(k.text.slice(l+1,b));k=(k.ch=b+1,l?"selfClose":"regular");break a}k.ch=b}if(!k)break;if("selfClose"!=k){k=a.line;b=a.ch;l=d(a);if(!l)break;if(l[1])g.push(l[2]);else{for(var h=g.length-1;0<=h;--h)if(g[h]==l[2]){g.length=h;break}if(0>h&&(!f||f==l[2]))return{tag:l[2],from:p(a.line,a.ch),to:p(k,b)}}}else d(a)}}
var p=b.Pos,l=RegExp("\x3c(/?)([A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");b.registerHelper("fold","xml",function(b,f){for(var g=new n(b,f.line,0);;){var k,
c=h(g);if(!c||g.line!=f.line||!(k=a(g)))break;if(!c[1]&&"selfClose"!=k)return k=p(g.line,g.ch),(g=t(g,c[2]))&&{from:k,to:g.from}}});b.findMatchingTag=function(b,f,g){var k=new n(b,f.line,f.ch,g);if(-1!=k.text.indexOf("\x3e")||-1!=k.text.indexOf("\x3c")){var c=a(k),l=c&&p(k.line,k.ch),h=c&&d(k);if(c&&h&&!(0<(k.line-f.line||k.ch-f.ch)))return f={from:p(k.line,k.ch),to:l,tag:h[2]},"selfClose"==c?{open:f,close:null,at:"open"}:h[1]?{open:q(k,h[2]),close:f,at:"close"}:(k=new n(b,l.line,l.ch,g),{open:f,
close:t(k,h[2]),at:"open"})}};b.findEnclosingTag=function(a,b,g,k){for(var c=new n(a,b.line,b.ch,g);;){var l=q(c,k);if(!l)break;var h=new n(a,b.line,b.ch,g);if(h=t(h,l.tag))return{open:l,close:h}}};b.scanForClosingTag=function(a,b,g,k){return t(new n(a,b.line,b.ch,k?{from:0,to:k}:null),g)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/closetag.js",["../../lib/codemirror","../fold/xml-fold"],b):b(CodeMirror)})(function(b){function n(h){if(h.getOption("disableInput"))return b.Pass;for(var t=h.listSelections(),q=[],p=0;p<t.length;p++){if(!t[p].empty())return b.Pass;var l=t[p].head,m=h.getTokenAt(l),f=b.innerMode(h.getMode(),m.state),g=f.state;if("xml"!=
f.mode.name||!g.tagName)return b.Pass;var k=h.getOption("autoCloseTags"),v="html"==f.mode.configuration,f="object"==typeof k&&k.dontCloseTags||v&&a,v="object"==typeof k&&k.indentTags||v&&d,k=g.tagName;m.end>l.ch&&(k=k.slice(0,k.length-m.end+l.ch));var r=k.toLowerCase();if(!k||"string"==m.type&&(m.end!=l.ch||!/[\"\']/.test(m.string.charAt(m.string.length-1))||1==m.string.length)||"tag"==m.type&&"closeTag"==g.type||m.string.indexOf("/")==m.string.length-1||f&&-1<e(f,r)||c(h,k,l,g,!0))return b.Pass;
m=v&&-1<e(v,r);q[p]={indent:m,text:"\x3e"+(m?"\n\n":"")+"\x3c/"+k+"\x3e",newPos:m?b.Pos(l.line+1,0):b.Pos(l.line,l.ch+1)}}for(p=t.length-1;0<=p;p--)l=q[p],h.replaceRange(l.text,t[p].head,t[p].anchor,"+insert"),m=h.listSelections().slice(0),m[p]={head:l.newPos,anchor:l.newPos},h.setSelections(m),l.indent&&(h.indentLine(l.newPos.line,null,!0),h.indentLine(l.newPos.line+1,null,!0))}function r(a,d){for(var q=a.listSelections(),p=[],l=d?"/":"\x3c/",m=0;m<q.length;m++){if(!q[m].empty())return b.Pass;var f=
q[m].head,g=a.getTokenAt(f),k=b.innerMode(a.getMode(),g.state),e=k.state;if(d&&("string"==g.type||"\x3c"!=g.string.charAt(0)||g.start!=f.ch-1))return b.Pass;if("xml"!=k.mode.name)if("htmlmixed"==a.getMode().name&&"javascript"==k.mode.name)k=l+"script";else{if("htmlmixed"!=a.getMode().name||"css"!=k.mode.name)return b.Pass;k=l+"style"}else{if(!e.context||!e.context.tagName||c(a,e.context.tagName,f,e))return b.Pass;k=l+e.context.tagName}"\x3e"!=a.getLine(f.line).charAt(g.end)&&(k+="\x3e");p[m]=k}a.replaceSelections(p);
q=a.listSelections();for(m=0;m<q.length;m++)(m==q.length-1||q[m].head.line<q[m+1].head.line)&&a.indentLine(q[m].head.line)}function e(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;++c)if(a[c]==b)return c;return-1}function c(a,c,d,p,l){if(!b.scanForClosingTag)return!1;var m=Math.min(a.lastLine()+1,d.line+500);d=b.scanForClosingTag(a,d,null,m);if(!d||d.tag!=c)return!1;p=p.context;for(l=l?1:0;p&&p.tagName==c;p=p.prev)++l;d=d.to;for(p=1;p<l;p++){d=b.scanForClosingTag(a,d,null,m);if(!d||
d.tag!=c)return!1;d=d.to}return!0}b.defineOption("autoCloseTags",!1,function(a,c,d){if(d!=b.Init&&d&&a.removeKeyMap("autoCloseTags"),c)d={name:"autoCloseTags"},("object"!=typeof c||c.whenClosing)&&(d["'/'"]=function(a){return a.getOption("disableInput")?b.Pass:r(a,!0)}),("object"!=typeof c||c.whenOpening)&&(d["'\x3e'"]=function(a){return n(a)}),a.addKeyMap(d)});var a="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),d="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ");
b.commands.closeTag=function(a){return r(a)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/matchbrackets.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(a,b,c){var m=a.getLineHandle(b.line),f=b.ch-1,g=c&&c.afterCursor;null==g&&(g=/(^| )cm-fat-cursor($| )/.test(a.getWrapperElement().className));m=!g&&0<=f&&h[m.text.charAt(f)]||h[m.text.charAt(++f)];if(!m)return null;g="\x3e"==m.charAt(1)?1:-1;if(c&&c.strict&&0<g!=
(f==b.ch))return null;var k=a.getTokenTypeAt(d(b.line,f+1));a=r(a,d(b.line,f+(0<g?1:0)),g,k||null,c);return null==a?null:{from:d(b.line,f),to:a&&a.pos,match:a&&a.ch==m.charAt(0),forward:0<g}}function r(a,b,c,m,f){var g=f&&f.maxScanLineLength||1E4,k=f&&f.maxScanLines||1E3,e=[];f=f&&f.bracketRegex?f.bracketRegex:/[(){}[\]]/;for(var k=0<c?Math.min(b.line+k,a.lastLine()+1):Math.max(a.firstLine()-1,b.line-k),t=b.line;t!=k;t+=c){var r=a.getLine(t);if(r){var n=0<c?0:r.length-1,E=0<c?r.length:-1;if(!(r.length>
g))for(t==b.line&&(n=b.ch-(0>c?1:0));n!=E;n+=c){var A=r.charAt(n);if(f.test(A)&&(void 0===m||a.getTokenTypeAt(d(t,n+1))==m))if("\x3e"==h[A].charAt(1)==0<c)e.push(A);else{if(!e.length)return{pos:d(t,n),ch:A};e.pop()}}}}return t-c!=(0<c?a.lastLine():a.firstLine())&&null}function e(c,b,l){for(var h=c.state.matchBrackets.maxHighlightLineLength||1E3,f=[],g=c.listSelections(),k=0;k<g.length;k++){var e=g[k].empty()&&n(c,g[k].head,l);if(e&&c.getLine(e.from.line).length<=h){var t=e.match?"CodeMirror-matchingbracket":
"CodeMirror-nonmatchingbracket";f.push(c.markText(e.from,d(e.from.line,e.from.ch+1),{className:t}));e.to&&c.getLine(e.to.line).length<=h&&f.push(c.markText(e.to,d(e.to.line,e.to.ch+1),{className:t}))}}if(f.length){a&&c.state.focused&&c.focus();l=function(){c.operation(function(){for(var a=0;a<f.length;a++)f[a].clear()})};if(!b)return l;setTimeout(l,800)}}function c(a){a.operation(function(){t&&(t(),t=null);t=e(a,!1,a.state.matchBrackets)})}var a=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||
8>document.documentMode),d=b.Pos,h={"(":")\x3e",")":"(\x3c","[":"]\x3e","]":"[\x3c","{":"}\x3e","}":"{\x3c"},t=null;b.defineOption("matchBrackets",!1,function(a,d,l){l&&l!=b.Init&&(a.off("cursorActivity",c),t&&(t(),t=null));d&&(a.state.matchBrackets="object"==typeof d?d:{},a.on("cursorActivity",c))});b.defineExtension("matchBrackets",function(){e(this,!0)});b.defineExtension("findMatchingBracket",function(a,c,b){return(b||"boolean"==typeof c)&&(b?(b.strict=c,c=b):c=c?{strict:!0}:null),n(this,a,c)});
b.defineExtension("scanForBracket",function(a,c,b,d){return r(this,a,c,b,d)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define("addon/edit/matchtags.js",["../../lib/codemirror","../fold/xml-fold"],b):b(CodeMirror)})(function(b){function n(c){c.state.tagHit&&c.state.tagHit.clear();c.state.tagOther&&c.state.tagOther.clear();c.state.tagHit=c.state.tagOther=null}function r(c){c.state.failedTagMatch=!1;c.operation(function(){if(n(c),!c.somethingSelected()){var a=
c.getCursor(),d=c.getViewport();d.from=Math.min(d.from,a.line);d.to=Math.max(a.line+1,d.to);if(a=b.findMatchingTag(c,a,d))c.state.matchBothTags&&(d="open"==a.at?a.open:a.close)&&(c.state.tagHit=c.markText(d.from,d.to,{className:"CodeMirror-matchingtag"})),(a="close"==a.at?a.open:a.close)?c.state.tagOther=c.markText(a.from,a.to,{className:"CodeMirror-matchingtag"}):c.state.failedTagMatch=!0}})}function e(c){c.state.failedTagMatch&&r(c)}b.defineOption("matchTags",!1,function(c,a,d){d&&d!=b.Init&&(c.off("cursorActivity",
r),c.off("viewportChange",e),n(c));a&&(c.state.matchBothTags="object"==typeof a&&a.bothTags,c.on("cursorActivity",r),c.on("viewportChange",e),r(c))});b.commands.toMatchingTag=function(c){var a=b.findMatchingTag(c,c.getCursor());a&&(a="close"==a.at?a.open:a.close)&&c.extendSelection(a.to,a.from)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/edit/trailingspace.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineOption("showTrailingSpace",!1,function(n,r,e){e==b.Init&&(e=!1);e&&!r?n.removeOverlay("trailingspace"):!e&&r&&n.addOverlay({token:function(c){for(var a=c.string.length,b=a;b&&/\s/.test(c.string.charAt(b-1));--b);return b>c.pos?(c.pos=b,null):(c.pos=a,"trailingspace")},
name:"trailingspace"})})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/foldcode",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(a,c,h,t){function q(g){var b=p(a,c);if(!b||b.to.line-b.from.line<l)return null;for(var f=a.findMarksAt(b.from),h=0;h<f.length;++h)if(f[h].__isFold&&"fold"!==t){if(!g)return null;b.cleared=!0;f[h].clear()}return b}if(h&&h.call){var p=h;h=null}else p=e(a,h,"rangeFinder");
"number"==typeof c&&(c=b.Pos(c,0));var l=e(a,h,"minFoldSize"),m=q(!0);if(e(a,h,"scanUp"))for(;!m&&c.line>a.firstLine();)c=b.Pos(c.line-1,0),m=q(!1);if(m&&!m.cleared&&"unfold"!==t){var f=r(a,h);b.on(f,"mousedown",function(a){g.clear();b.e_preventDefault(a)});var g=a.markText(m.from,m.to,{replacedWith:f,clearOnEnter:e(a,h,"clearOnEnter"),__isFold:!0});g.on("clear",function(g,c){b.signal(a,"unfold",a,g,c)});b.signal(a,"fold",a,m.from,m.to)}}function r(a,c){var b=e(a,c,"widget");if("string"==typeof b){var t=
document.createTextNode(b),b=document.createElement("span");b.appendChild(t);b.className="CodeMirror-foldmarker"}else b&&(b=b.cloneNode(!0));return b}function e(a,b,h){return b&&void 0!==b[h]?b[h]:(a=a.options.foldOptions)&&void 0!==a[h]?a[h]:c[h]}b.newFoldFunction=function(a,b){return function(c,e){n(c,e,{rangeFinder:a,widget:b})}};b.defineExtension("foldCode",function(a,b,c){n(this,a,b,c)});b.defineExtension("isFolded",function(a){a=this.findMarksAt(a);for(var b=0;b<a.length;++b)if(a[b].__isFold)return!0});
b.commands.toggleFold=function(a){a.foldCode(a.getCursor())};b.commands.fold=function(a){a.foldCode(a.getCursor(),null,"fold")};b.commands.unfold=function(a){a.foldCode(a.getCursor(),null,"unfold")};b.commands.foldAll=function(a){a.operation(function(){for(var c=a.firstLine(),h=a.lastLine();c<=h;c++)a.foldCode(b.Pos(c,0),null,"fold")})};b.commands.unfoldAll=function(a){a.operation(function(){for(var c=a.firstLine(),h=a.lastLine();c<=h;c++)a.foldCode(b.Pos(c,0),null,"unfold")})};b.registerHelper("fold",
"combine",function(){var a=Array.prototype.slice.call(arguments,0);return function(c,b){for(var e=0;e<a.length;++e){var r=a[e](c,b);if(r)return r}}});b.registerHelper("fold","auto",function(a,c){for(var b=a.getHelpers(c,"fold"),e=0;e<b.length;e++){var r=b[e](a,c);if(r)return r}});var c={rangeFinder:b.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};b.defineOption("foldOptions",null);b.defineExtension("foldOption",function(a,c){return e(this,a,c)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define("addon/fold/foldgutter.js",["../../lib/codemirror","./foldcode"],b):b(CodeMirror)})(function(b){function n(a){this.options=a;this.from=this.to=0}function r(a,c){for(var b=a.findMarks(p(c,0),p(c+1,0)),g=0;g<b.length;++g)if(b[g].__isFold&&b[g].find().from.line==c)return b[g]}function e(a){if("string"==typeof a){var c=document.createElement("div");
return c.className=a+" CodeMirror-guttermarker-subtle",c}return a.cloneNode(!0)}function c(a,c,b){var g=a.state.foldGutter.options,k=c,d=a.foldOption(g,"minFoldSize"),h=a.foldOption(g,"rangeFinder");a.eachLine(c,b,function(c){var b=null;if(r(a,k))b=e(g.indicatorFolded);else{var f=p(k,0);(f=h&&h(a,f))&&f.to.line-f.from.line>=d&&(b=e(g.indicatorOpen))}a.setGutterMarker(c,g.gutter,b);++k})}function a(a){var b=a.getViewport(),f=a.state.foldGutter;f&&(a.operation(function(){c(a,b.from,b.to)}),f.from=b.from,
f.to=b.to)}function d(a,c,b){var g=a.state.foldGutter;g&&(g=g.options,b==g.gutter&&((b=r(a,c))?b.clear():a.foldCode(p(c,0),g.rangeFinder)))}function h(b){var c=b.state.foldGutter;if(c){var f=c.options;c.from=c.to=0;clearTimeout(c.changeUpdate);c.changeUpdate=setTimeout(function(){a(b)},f.foldOnChangeTimeSpan||600)}}function t(b){var d=b.state.foldGutter;if(d){var f=d.options;clearTimeout(d.changeUpdate);d.changeUpdate=setTimeout(function(){var g=b.getViewport();d.from==d.to||20<g.from-d.to||20<d.from-
g.to?a(b):b.operation(function(){g.from<d.from&&(c(b,g.from,d.from),d.from=g.from);g.to>d.to&&(c(b,d.to,g.to),d.to=g.to)})},f.updateViewportTimeSpan||400)}}function q(a,b){var f=a.state.foldGutter;if(f){var g=b.line;g>=f.from&&g<f.to&&c(a,g,g+1)}}b.defineOption("foldGutter",!1,function(c,e,f){f&&f!=b.Init&&(c.clearGutter(c.state.foldGutter.options.gutter),c.state.foldGutter=null,c.off("gutterClick",d),c.off("change",h),c.off("viewportChange",t),c.off("fold",q),c.off("unfold",q),c.off("swapDoc",h));
if(e){f=c.state;var g=e;e=(!0===g&&(g={}),null==g.gutter&&(g.gutter="CodeMirror-foldgutter"),null==g.indicatorOpen&&(g.indicatorOpen="CodeMirror-foldgutter-open"),null==g.indicatorFolded&&(g.indicatorFolded="CodeMirror-foldgutter-folded"),g);f.foldGutter=new n(e);a(c);c.on("gutterClick",d);c.on("change",h);c.on("viewportChange",t);c.on("fold",q);c.on("unfold",q);c.on("swapDoc",h)}});var p=b.Pos});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/brace-fold.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.registerHelper("fold","brace",function(n,r){function e(g){for(var k=r.ch,f=0;;)if(k=0>=k?-1:d.lastIndexOf(g,k-1),-1!=k){if(1==f&&k<r.ch)break;if(c=n.getTokenTypeAt(b.Pos(a,k+1)),!/^(comment|string)/.test(c))return k+1;--k}else{if(1==f)break;f=1;k=d.length}}var c,a=r.line,d=
n.getLine(a),h="{",t="}",q=e("{");if(null==q&&(h="[",t="]",q=e("[")),null!=q){var p,l,m=1,f=n.lastLine(),g=a;a:for(;g<=f;++g)for(var k=n.getLine(g),v=g==a?q:0;;){var x=k.indexOf(h,v),B=k.indexOf(t,v);if(0>x&&(x=k.length),0>B&&(B=k.length),(v=Math.min(x,B))==k.length)break;if(n.getTokenTypeAt(b.Pos(g,v+1))==c)if(v==x)++m;else if(!--m){p=g;l=v;break a}++v}if(null!=p&&(a!=p||l!=q))return{from:b.Pos(a,q),to:b.Pos(p,l)}}});b.registerHelper("fold","import",function(n,r){function e(a){if(a<n.firstLine()||
a>n.lastLine())return null;var c=n.getTokenAt(b.Pos(a,1));if(/\S/.test(c.string)||(c=n.getTokenAt(b.Pos(a,c.end+1))),"keyword"!=c.type||"import"!=c.string)return null;var d=a;for(a=Math.min(n.lastLine(),a+10);d<=a;++d){var e=n.getLine(d).indexOf(";");if(-1!=e)return{startCh:c.end,end:b.Pos(d,e)}}}var c,a=r.line,d=e(a);if(!d||e(a-1)||(c=e(a-2))&&c.end.line==a-1)return null;for(c=d.end;;){var h=e(c.line+1);if(null==h)break;c=h.end}return{from:n.clipPos(b.Pos(a,d.startCh+1)),to:c}});b.registerHelper("fold",
"include",function(n,r){function e(a){if(a<n.firstLine()||a>n.lastLine())return null;var c=n.getTokenAt(b.Pos(a,1));return/\S/.test(c.string)||(c=n.getTokenAt(b.Pos(a,c.end+1))),"meta"==c.type&&"#include"==c.string.slice(0,8)?c.start+8:void 0}var c=r.line,a=e(c);if(null==a||null!=e(c-1))return null;for(var d=c;null!=e(d+1);)++d;return{from:b.Pos(c,a+1),to:n.clipPos(b.Pos(d))}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/comment-fold.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.registerGlobalHelper("fold","comment",function(b){return b.blockCommentStart&&b.blockCommentEnd},function(n,r){var e=n.getModeAt(r),c=e.blockCommentStart,e=e.blockCommentEnd;if(c&&e){var a,d=r.line;a=n.getLine(d);for(var h=r.ch,t=0;;)if(h=0>=h?-1:a.lastIndexOf(c,h-1),-1!=
h){if(1==t&&h<r.ch)return;if(/comment/.test(n.getTokenTypeAt(b.Pos(d,h+1)))&&(0==h||a.slice(h-e.length,h)==e||!/comment/.test(n.getTokenTypeAt(b.Pos(d,h))))){a=h+c.length;break}--h}else{if(1==t)return;t=1;h=a.length}var q,p,t=1,h=n.lastLine(),l=d;a:for(;l<=h;++l)for(var m=n.getLine(l),f=l==d?a:0;;){var g=m.indexOf(c,f),k=m.indexOf(e,f);if(0>g&&(g=m.length),0>k&&(k=m.length),(f=Math.min(g,k))==m.length)break;if(f==g)++t;else if(!--t){q=l;p=f;break a}++f}if(null!=q&&(d!=q||p!=a))return{from:b.Pos(d,
a),to:b.Pos(q,p)}}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/fold/indent-fold.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(r,e){var c=r.getLine(e),a=c.search(/\S/);return-1==a||/\bcomment\b/.test(r.getTokenTypeAt(b.Pos(e,a+1)))?-1:b.countColumn(c,null,r.getOption("tabSize"))}b.registerHelper("fold","indent",function(r,e){var c=n(r,e.line);if(!(0>c)){for(var a=null,d=e.line+1,h=r.lastLine();d<=
h;++d){var t=n(r,d);if(-1!=t){if(!(t>c))break;a=d}}return a?{from:b.Pos(e.line,r.getLine(e.line).length),to:b.Pos(a,r.getLine(a).length)}:void 0}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/autoFormatAll.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineExtension("autoFormatAll",function(n,r){for(var e=this,c=e.getMode(),a=e.getRange(n,r).split("\n"),d=b.copyState(c,e.getTokenAt(n).state),h=e.getOption("tabSize"),t="",q=0,p=0==n.ch,l=0;l<a.length;++l){for(var m=new b.StringStream(a[l],h);!m.eol();){var f=b.innerMode(c,
d),g=c.token(m,d),k=m.current();m.start=m.pos;p&&!/\S/.test(k)||(t+=k,p=!1);!p&&f.mode.newlineAfterToken&&f.mode.newlineAfterToken(g,k,m.string.slice(m.pos)||a[l+1]||"",f.state)&&(t+="\n",p=!0,++q)}!m.pos&&c.blankLine&&c.blankLine(d);!p&&l<a.length-1&&(t+="\n",p=!0,++q)}e.operation(function(){e.replaceRange(t,n,r);for(var a=n.line+1,c=n.line+q;a<=c;++a)e.indentLine(a,"smart");e.setCursor({line:0,ch:0})})})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/format/formatting.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(b){for(var e=[/for\s*?\((.*?)\)/g,/&#?[a-z0-9]+;[\s\S]/g,/\"(.*?)((\")|$)/g,/\/\*(.*?)(\*\/|$)/g,/^\/\/.*/g],c=[],a=0;a<e.length;a++)for(var d=0;d<b.length;){var h=b.substr(d).match(e[a]);if(null==h)break;c.push({start:d+h.index,end:d+h.index+h[0].length});d+=h.index+
Math.max(1,h[0].length)}return c.sort(function(a,c){return a.start-c.start}),c}b.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(b,e){return/^[;{}]$/.test(e)}});b.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(b){var e=0,c=this.jsonMode?function(a){return a.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}")}:function(a){return a.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2")},a=n(b),d="";if(null!=a){for(var h=
0;h<a.length;h++)a[h].start>e&&(d+=c(b.substring(e,a[h].start)),e=a[h].start),a[h].start<=e&&a[h].end>=e&&(d+=b.substring(e,a[h].end),e=a[h].end);e<b.length&&(d+=c(b.substr(e)))}else d=c(b);return d.replace(/^\n*|\n*$/,"")}});b.extendMode("xml",{commentStart:"\x3c!--",commentEnd:"--\x3e",noBreak:!1,noBreakEmpty:null,tagType:"",tagName:"",isXML:!1,newlineAfterToken:function(b,e,c,a){a=!1;var d=null,h="";if(this.isXML="xml"==this.configuration,"comment"==b||/\x3c!--/.test(c))return!1;if("tag"==b){0==
e.indexOf("\x3c")&&0==!e.indexOf("\x3c/")&&(this.tagType="open",d=e.match(/^<\s*?([\w]+?)$/i),this.tagName=null!=d?d[1]:"",h=this.tagName.toLowerCase(),-1!="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0));if(0==e.indexOf("\x3e")&&"open"==this.tagType)return this.tagType="",RegExp("^"+(this.isXML?"[^\x3c]*?":"")+"\x3c/s*?"+this.tagName+"s*?\x3e","i").test(c)?(this.noBreak=!1,this.isXML||
(this.tagName=""),!1):(a=this.noBreak,this.noBreak=!1,!a);if(0==e.indexOf("\x3c/")&&(this.tagType="close",d=e.match(/^<\/\s*?([\w]+?)$/i),null!=d&&(h=d[1].toLowerCase()),-1!="|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")&&(this.noBreak=!0)),0==e.indexOf("\x3e")&&"close"==this.tagType)return this.tagType="",0==c.indexOf("\x3c")&&(d=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=d?d[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+
h+"|"))?(this.noBreak=!1,!0):(a=this.noBreak,this.noBreak=!1,!a)}return 0==c.indexOf("\x3c")&&(this.noBreak=!1,this.isXML&&""!=this.tagName?(this.tagName="",!1):(d=c.match(/^<\/?\s*?([\w]+?)(\s|>)/i),h=null!=d?d[1].toLowerCase():"",-1=="|label|li|option|textarea|title|a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u|".indexOf("|"+h+"|")))}});b.defineExtension("commentRange",function(r,e,c){var a=this,d=b.innerMode(a.getMode(),a.getTokenAt(e).state).mode;a.operation(function(){if(r)a.replaceRange(d.commentEnd,
c),a.replaceRange(d.commentStart,e),a.setSelection(e,{line:c.line,ch:c.ch+d.commentStart.length+d.commentEnd.length}),e.line==c.line&&e.ch==c.ch&&a.setCursor(e.line,e.ch+d.commentStart.length);else{var b=a.getRange(e,c),t=b.indexOf(d.commentStart),q=b.lastIndexOf(d.commentEnd);-1<t&&-1<q&&q>t&&(b=b.substr(0,t)+b.substring(t+d.commentStart.length,q)+b.substr(q+d.commentEnd.length));a.replaceRange(b,e,c);a.setSelection(e,{line:c.line,ch:c.ch-d.commentStart.length-d.commentEnd.length})}})});b.defineExtension("autoIndentRange",
function(b,e){var c=this;this.operation(function(){for(var a=b.line;a<=e.line;a++)c.indentLine(a,"smart")})});b.defineExtension("autoFormatRange",function(r,e){for(var c=this,a=c.getMode(),d=c.getRange(r,e).split("\n"),h=b.copyState(a,c.getTokenAt(r).state),t=c.getOption("tabSize"),q="",p=0,l=0==r.ch,m=0;m<d.length;++m){for(var f=new b.StringStream(d[m],t);!f.eol();){var g=b.innerMode(a,h),k=a.token(f,h),n=f.current();f.start=f.pos;l&&!/\S/.test(n)||(q+=n,l=!1);!l&&g.mode.newlineAfterToken&&g.mode.newlineAfterToken(k,
n,f.string.slice(f.pos)||d[m+1]||"",g.state)&&(q+="\n",l=!0,++p)}!f.pos&&a.blankLine&&a.blankLine(h);!l&&m<d.length-1&&(q+="\n",l=!0,++p)}c.operation(function(){c.replaceRange(q,r,e);for(var a=r.line+1,b=r.line+p;a<=b;++a)c.indentLine(a,"smart");c.setSelection(r,c.getCursor(!1))})})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/selection/active-line.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(c){for(var b=0;b<c.state.activeLines.length;b++)c.removeLineClass(c.state.activeLines[b],"wrap",a),c.removeLineClass(c.state.activeLines[b],"background",d),c.removeLineClass(c.state.activeLines[b],"gutter",h)}function r(a,c){if(a.length!=c.length)return!1;for(var b=
0;b<a.length;b++)if(a[b]!=c[b])return!1;return!0}function e(c,b){for(var e=[],l=0;l<b.length;l++){var m=b[l],f=c.getOption("styleActiveLine");if("object"==typeof f&&f.nonEmpty?m.anchor.line==m.head.line:m.empty())m=c.getLineHandleVisualStart(m.head.line),e[e.length-1]!=m&&e.push(m)}r(c.state.activeLines,e)||c.operation(function(){n(c);for(var b=0;b<e.length;b++)c.addLineClass(e[b],"wrap",a),c.addLineClass(e[b],"background",d),c.addLineClass(e[b],"gutter",h);c.state.activeLines=e})}function c(a,c){e(a,
c.ranges)}var a="CodeMirror-activeline",d="CodeMirror-activeline-background",h="CodeMirror-activeline-gutter";b.defineOption("styleActiveLine",!1,function(a,d,h){h=h!=b.Init&&h;d!=h&&(h&&(a.off("beforeSelectionChange",c),n(a),delete a.state.activeLines),d&&(a.state.activeLines=[],e(a,a.listSelections()),a.on("beforeSelectionChange",c)))})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/search/searchcursor",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(a){if(!a.global){var c=a.flags;a=new RegExp(a.source,(null!=c?c:(a.ignoreCase?"i":"")+(a.global?"g":"")+(a.multiline?"m":""))+"g")}return a}function r(a,c,b){c=n(c);var d=b.line,e=b.ch;for(b=a.lastLine();d<=b;d++,e=0)if(c.lastIndex=e,e=a.getLine(d),e=c.exec(e))return{from:f(d,
e.index),to:f(d,e.index+e[0].length),match:e}}function e(a,c,b){if(!/\\s|\\n|\n|\\W|\\D|\[\^/.test(c.source))return r(a,c,b);c=n(c);for(var d,e=1,h=b.line,l=a.lastLine();h<=l;){for(var p=0;p<e;p++){var m=a.getLine(h++);d=null==d?m:d+"\n"+m}e*=2;c.lastIndex=b.ch;if(p=c.exec(d))return c=d.slice(0,p.index).split("\n"),a=p[0].split("\n"),b=b.line+c.length-1,c=c[c.length-1].length,{from:f(b,c),to:f(b+a.length-1,1==a.length?c+a[0].length:a[a.length-1].length),match:p}}}function c(a,c){for(var b,f=0;;){c.lastIndex=
f;var d=c.exec(a);if(!d||(b=d,(f=b.index+(b[0].length||1))==a.length))return b}}function a(a,b,d){b=n(b);var e=d.line,h=d.ch;for(d=a.firstLine();e>=d;e--,h=-1){var l=a.getLine(e);-1<h&&(l=l.slice(0,h));if(h=c(l,b))return{from:f(e,h.index),to:f(e,h.index+h[0].length),match:h}}}function d(a,b,d){b=n(b);for(var e,h=1,l=d.line,p=a.firstLine();l>=p;){for(var m=0;m<h;m++){var r=a.getLine(l--);e=null==e?r.slice(0,d.ch):r+"\n"+e}h*=2;if(m=c(e,b))return b=e.slice(0,m.index).split("\n"),a=m[0].split("\n"),
l+=b.length,b=b[b.length-1].length,{from:f(l,b),to:f(l+a.length-1,1==a.length?b+a[0].length:a[a.length-1].length),match:m}}}function h(a,b,c,f){if(a.length==b.length)return c;var d=0;for(b=c+Math.max(0,a.length-b.length);;){if(d==b)return d;var e=d+b>>1,h=f(a.slice(0,e)).length;if(h==c)return e;h>c?b=e:d=e+1}}function t(a,b,c,d){if(!b.length)return null;d=d?l:m;b=d(b).split(/\r|\n\r?/);var e=c.line;c=c.ch;var p=a.lastLine()+1-b.length;a:for(;e<=p;e++,c=0){var r=a.getLine(e).slice(c),n=d(r);if(1==
b.length){var q=n.indexOf(b[0]);if(-1==q)continue a;h(r,n,q,d);return{from:f(e,h(r,n,q,d)+c),to:f(e,h(r,n,q+b[0].length,d)+c)}}q=n.length-b[0].length;if(n.slice(q)==b[0]){for(var t=1;t<b.length-1;t++)if(d(a.getLine(e+t))!=b[t])continue a;var t=a.getLine(e+b.length-1),u=d(t),y=b[b.length-1];if(t.slice(0,y.length)==y)return{from:f(e,h(r,n,q,d)+c),to:f(e+b.length-1,h(t,u,y.length,d))}}}}function q(a,b,c,d){if(!b.length)return null;d=d?l:m;b=d(b).split(/\r|\n\r?/);var e=c.line,p=c.ch,r=a.firstLine()-
1+b.length;a:for(;e>=r;e--,p=-1){var n=a.getLine(e);-1<p&&(n=n.slice(0,p));p=d(n);if(1==b.length){c=p.lastIndexOf(b[0]);if(-1==c)continue a;return{from:f(e,h(n,p,c,d)),to:f(e,h(n,p,c+b[0].length,d))}}var t=b[b.length-1];if(p.slice(0,t.length)==t){var q=1;for(c=e-b.length+1;q<b.length-1;q++)if(d(a.getLine(c+q))!=b[q])continue a;c=a.getLine(e+1-b.length);q=d(c);if(q.slice(q.length-b[0].length)==b[0])return{from:f(e+1-b.length,h(c,q,c.length-b[0].length,d)),to:f(e,h(n,p,t.length,d))}}}}function p(b,
c,h,l){this.atOccurrence=!1;this.doc=b;h=h?b.clipPos(h):f(0,0);this.pos={from:h,to:h};var p;"object"==typeof l?p=l.caseFold:(p=l,l=null);"string"==typeof c?(null==p&&(p=!1),this.matches=function(a,d){return(a?q:t)(b,c,d,p)}):(c=n(c),l&&!1===l.multiline?this.matches=function(d,f){return(d?a:r)(b,c,f)}:this.matches=function(a,f){return(a?d:e)(b,c,f)})}var l,m,f=b.Pos;String.prototype.normalize?(l=function(a){return a.normalize("NFD").toLowerCase()},m=function(a){return a.normalize("NFD")}):(l=function(a){return a.toLowerCase()},
m=function(a){return a});p.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){for(var c=this.matches(a,this.doc.clipPos(a?this.pos.from:this.pos.to));c&&0==b.cmpPos(c.from,c.to);)a?c.from.ch?c.from=f(c.from.line,c.from.ch-1):c=c.from.line==this.doc.firstLine()?null:this.matches(a,this.doc.clipPos(f(c.from.line-1))):c.to.ch<this.doc.getLine(c.to.line).length?c.to=f(c.to.line,c.to.ch+1):c=c.to.line==this.doc.lastLine()?null:this.matches(a,
f(c.to.line+1,0));if(c)return this.pos=c,this.atOccurrence=!0,this.pos.match||!0;a=f(a?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:a,to:a},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(a,c){if(this.atOccurrence){var d=b.splitLines(a);this.doc.replaceRange(d,this.pos.from,this.pos.to,c);this.pos.to=f(this.pos.from.line+d.length-1,d[d.length-1].length+(1==d.length?this.pos.from.ch:
0))}}};b.defineExtension("getSearchCursor",function(a,c,b){return new p(this.doc,a,c,b)});b.defineDocExtension("getSearchCursor",function(a,c,b){return new p(this,a,c,b)});b.defineExtension("selectMatches",function(a,c){for(var d=[],f=this.getSearchCursor(a,this.getCursor("from"),c);f.findNext()&&!(0<b.cmpPos(f.to(),this.getCursor("to")));)d.push({anchor:f.from(),head:f.to()});d.length&&this.setSelections(d,0)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/scroll/annotatescrollbar",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function n(b,e){function c(c){clearTimeout(a.doRedraw);a.doRedraw=setTimeout(function(){a.redraw()},c)}this.cm=b;this.options=e;this.buttonHeight=e.scrollButtonHeight||b.getOption("scrollButtonHeight");this.annotations=[];this.doRedraw=this.doUpdate=null;this.div=b.getWrapperElement().appendChild(document.createElement("div"));
this.div.style.cssText="position: absolute; right: 0; top: 0; z-index: 7; pointer-events: none";this.computeScale();var a=this;b.on("refresh",this.resizeHandler=function(){clearTimeout(a.doUpdate);a.doUpdate=setTimeout(function(){a.computeScale()&&c(20)},100)});b.on("markerAdded",this.resizeHandler);b.on("markerCleared",this.resizeHandler);!1!==e.listenForChanges&&b.on("change",this.changeHandler=function(){c(250)})}b.defineExtension("annotateScrollbar",function(b){return"string"==typeof b&&(b={className:b}),
new n(this,b)});b.defineOption("scrollButtonHeight",0);n.prototype.computeScale=function(){var b=this.cm,b=(b.getWrapperElement().clientHeight-b.display.barHeight-2*this.buttonHeight)/b.getScrollerElement().scrollHeight;if(b!=this.hScale)return this.hScale=b,!0};n.prototype.update=function(b){this.annotations=b;this.redraw()};n.prototype.redraw=function(b){function e(a,b){return q!=a.line&&(q=a.line,p=c.getLineHandle(q)),p.widgets&&p.widgets.length||h&&p.height>n?c.charCoords(a,"local")[b?"top":"bottom"]:
c.heightAtLine(p,"local")+(b?0:p.height)}!1!==b&&this.computeScale();var c=this.cm;b=this.hScale;var a=document.createDocumentFragment(),d=this.annotations,h=c.getOption("lineWrapping"),n=h&&1.5*c.defaultTextHeight(),q=null,p=null,l=c.lastLine();if(c.display.barWidth)for(var m,f=0;f<d.length;f++){var g=d[f];if(!(g.to.line>l)){for(var k=m||e(g.from,!0)*b,v=e(g.to,!1)*b;f<d.length-1&&!(d[f+1].to.line>l)&&!((m=e(d[f+1].from,!0)*b)>v+.9);)g=d[++f],v=e(g.to,!1)*b;if(v!=k){var v=Math.max(v-k,3),x=a.appendChild(document.createElement("div"));
x.style.cssText="position: absolute; right: 0px; width: "+Math.max(c.display.barWidth-1,2)+"px; top: "+(k+this.buttonHeight)+"px; height: "+v+"px";x.className=this.options.className;g.id&&x.setAttribute("annotation-id",g.id)}}}this.div.textContent="";this.div.appendChild(a)};n.prototype.clear=function(){this.cm.off("refresh",this.resizeHandler);this.cm.off("markerAdded",this.resizeHandler);this.cm.off("markerCleared",this.resizeHandler);this.changeHandler&&this.cm.off("change",this.changeHandler);
this.div.parentNode.removeChild(this.div)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("./searchcursor"),require("../scroll/annotatescrollbar")):"function"==typeof define&&define.amd?define("addon/search/matchesonscrollbar",["../../lib/codemirror","./searchcursor","../scroll/annotatescrollbar"],b):b(CodeMirror)})(function(b){function n(b,c,a,d){this.cm=b;this.options=d;var h={listenForChanges:!1},n;for(n in d)h[n]=d[n];h.className||(h.className="CodeMirror-search-match");this.annotation=
b.annotateScrollbar(h);this.query=c;this.caseFold=a;this.gap={from:b.firstLine(),to:b.lastLine()+1};this.matches=[];this.update=null;this.findMatches();this.annotation.update(this.matches);var q=this;b.on("change",this.changeHandler=function(a,b){q.onChange(b)})}function r(b,c,a){return b<=c?b:Math.max(c,b+a)}b.defineExtension("showMatchesOnScrollbar",function(b,c,a){return"string"==typeof a&&(a={className:a}),a||(a={}),new n(this,b,c,a)});n.prototype.findMatches=function(){if(this.gap){for(var e=
0;e<this.matches.length;e++){var c=this.matches[e];if(c.from.line>=this.gap.to)break;c.to.line>=this.gap.from&&this.matches.splice(e--,1)}for(var a=this.cm.getSearchCursor(this.query,b.Pos(this.gap.from,0),this.caseFold),d=this.options&&this.options.maxMatches||1E3;a.findNext();){c={from:a.from(),to:a.to()};if(c.from.line>=this.gap.to)break;if(this.matches.splice(e++,0,c),this.matches.length>d)break}this.gap=null}};n.prototype.onChange=function(e){var c=e.from.line,a=b.changeEnd(e).line,d=a-e.to.line;
if(this.gap?(this.gap.from=Math.min(r(this.gap.from,c,d),e.from.line),this.gap.to=Math.max(r(this.gap.to,c,d),e.from.line)):this.gap={from:e.from.line,to:a+1},d)for(e=0;e<this.matches.length;e++){var a=this.matches[e],h=r(a.from.line,c,d);h!=a.from.line&&(a.from=b.Pos(h,a.from.ch));h=r(a.to.line,c,d);h!=a.to.line&&(a.to=b.Pos(h,a.to.ch))}clearTimeout(this.update);var n=this;this.update=setTimeout(function(){n.updateAfterChange()},250)};n.prototype.updateAfterChange=function(){this.findMatches();this.annotation.update(this.matches)};
n.prototype.clear=function(){this.cm.off("change",this.changeHandler);this.annotation.clear()}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("./matchesonscrollbar")):"function"==typeof define&&define.amd?define("addon/search/match-highlighter.js",["../../lib/codemirror","./matchesonscrollbar"],b):b(CodeMirror)})(function(b){function n(a){this.options={};for(var b in q)this.options[b]=(a&&a.hasOwnProperty(b)?a:q)[b];this.matchesonscroll=this.overlay=this.timeout=null;this.active=!1}function r(a){var b=a.state.matchHighlighter;(b.active||
a.hasFocus())&&c(a,b)}function e(a){var b=a.state.matchHighlighter;b.active||(b.active=!0,c(a,b))}function c(a,b){clearTimeout(b.timeout);b.timeout=setTimeout(function(){h(a)},b.options.delay)}function a(a,b,c,d){var e=a.state.matchHighlighter;if(a.addOverlay(e.overlay=t(b,c,d)),e.options.annotateScrollbar&&a.showMatchesOnScrollbar)e.matchesonscroll=a.showMatchesOnScrollbar(c?new RegExp("\\b"+b+"\\b"):b,!1,{className:"CodeMirror-selection-highlight-scrollbar"})}function d(a){var b=a.state.matchHighlighter;
b.overlay&&(a.removeOverlay(b.overlay),b.overlay=null,b.matchesonscroll&&(b.matchesonscroll.clear(),b.matchesonscroll=null))}function h(b){b.operation(function(){var c=b.state.matchHighlighter;if(d(b),!b.somethingSelected()&&c.options.showToken){for(var e=!0===c.options.showToken?/[\w$]/:c.options.showToken,f=b.getCursor(),g=b.getLine(f.line),h=f=f.ch;f&&e.test(g.charAt(f-1));)--f;for(;h<g.length&&e.test(g.charAt(h));)++h;return void(f<h&&a(b,g.slice(f,h),e,c.options.style))}e=b.getCursor("from");
g=b.getCursor("to");if((f=e.line==g.line)&&!(f=!c.options.wordsOnly))a:if(null!==b.getRange(e,g).match(/^\w+$/)){if(0<e.ch&&(f={line:e.line,ch:e.ch-1},f=b.getRange(f,e),null===f.match(/\W/))){f=!1;break a}if(g.ch<b.getLine(e.line).length&&(f={line:g.line,ch:g.ch+1},f=b.getRange(g,f),null===f.match(/\W/))){f=!1;break a}f=!0}else f=!1;f&&(e=b.getRange(e,g),c.options.trim&&(e=e.replace(/^\s+|\s+$/g,"")),e.length>=c.options.minChars&&a(b,e,!1,c.options.style))})}function t(a,b,c){return{token:function(d){var e;
if(e=d.match(a))(e=!b)||(e=!(d.start&&b.test(d.string.charAt(d.start-1))||d.pos!=d.string.length&&b.test(d.string.charAt(d.pos))));if(e)return c;d.next();d.skipTo(a.charAt(0))||d.skipToEnd()}}}var q={style:"matchhighlight",minChars:2,delay:100,wordsOnly:!1,annotateScrollbar:!1,showToken:!1,trim:!0};b.defineOption("highlightSelectionMatches",!1,function(a,c,m){if(m&&m!=b.Init&&(d(a),clearTimeout(a.state.matchHighlighter.timeout),a.state.matchHighlighter=null,a.off("cursorActivity",r),a.off("focus",
e)),c)c=a.state.matchHighlighter=new n(c),a.hasFocus()?(c.active=!0,h(a)):a.on("focus",e),a.on("cursorActivity",r)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define("addon/mode/multiplex.js",["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.multiplexingMode=function(n){function r(b,a,d,e){return"string"==typeof a?(d=b.indexOf(a,d),e&&-1<d?d+a.length:d):(a=a.exec(d?b.slice(d):b))?a.index+d+(e?a[0].length:0):-1}var e=Array.prototype.slice.call(arguments,1);return{startState:function(){return{outer:b.startState(n),
innerActive:null,inner:null}},copyState:function(c){return{outer:b.copyState(n,c.outer),innerActive:c.innerActive,inner:c.innerActive&&b.copyState(c.innerActive.mode,c.inner)}},token:function(c,a){if(a.innerActive){var d=a.innerActive,h=c.string;if(!d.close&&c.sol())return a.innerActive=a.inner=null,this.token(c,a);var t=d.close?r(h,d.close,c.pos,d.parseDelimiters):-1;if(t==c.pos&&!d.parseDelimiters)return c.match(d.close),a.innerActive=a.inner=null,d.delimStyle&&d.delimStyle+" "+d.delimStyle+"-close";
-1<t&&(c.string=h.slice(0,t));var q=d.mode.token(c,a.inner);return-1<t&&(c.string=h),t==c.pos&&d.parseDelimiters&&(a.innerActive=a.inner=null),d.innerStyle&&(q=q?q+" "+d.innerStyle:d.innerStyle),q}d=1/0;h=c.string;for(q=0;q<e.length;++q){var p=e[q],t=r(h,p.open,c.pos);if(t==c.pos)return p.parseDelimiters||c.match(p.open),a.innerActive=p,a.inner=b.startState(p.mode,n.indent?n.indent(a.outer,""):0),p.delimStyle&&p.delimStyle+" "+p.delimStyle+"-open";-1!=t&&t<d&&(d=t)}d!=1/0&&(c.string=h.slice(0,d));
t=n.token(c,a.outer);return d!=1/0&&(c.string=h),t},indent:function(c,a){var d=c.innerActive?c.innerActive.mode:n;return d.indent?d.indent(c.innerActive?c.inner:c.outer,a):b.Pass},blankLine:function(c){var a=c.innerActive?c.innerActive.mode:n;if(a.blankLine&&a.blankLine(c.innerActive?c.inner:c.outer),c.innerActive)"\n"===c.innerActive.close&&(c.innerActive=c.inner=null);else for(var d=0;d<e.length;++d){var h=e[d];"\n"===h.open&&(c.innerActive=h,c.inner=b.startState(h.mode,a.indent?a.indent(c.outer,
""):0))}},electricChars:n.electricChars,innerMode:function(b){return b.inner?{state:b.inner,mode:b.innerActive.mode}:{state:b.outer,mode:n}}}}});
(function(b){"function"==typeof b.define&&b.define("addons","addon/comment/continuecomment.js addon/edit/closebrackets.js addon/edit/closetag.js addon/edit/matchbrackets.js addon/edit/matchtags.js addon/edit/trailingspace.js addon/fold/foldgutter.js addon/fold/brace-fold.js addon/fold/comment-fold.js addon/fold/indent-fold.js addon/format/autoFormatAll.js addon/format/formatting.js addon/selection/active-line.js addon/search/match-highlighter.js addon/mode/multiplex.js".split(" "),function(){})})(this);